<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>vqwww: freemail: html.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.3 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a></div>
<h1>html.cc</h1><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;new&gt;</span>
00002 <span class="preprocessor">#include &lt;inttypes.h&gt;</span>
00003 <span class="preprocessor">#include "html.h"</span>
00004 <span class="preprocessor">#include &lt;iostream&gt;</span>
00005 
00006 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00012 <span class="keywordtype">bool</span> htmlbad( string &amp; s, <span class="keyword">const</span> <span class="keywordtype">char</span> * HTMLOK, <span class="keyword">const</span> <span class="keywordtype">char</span> HTMLBADREP )
00013 {
00014     <span class="keywordtype">bool</span> chg = <span class="keyword">false</span>;
00015     string::size_type oklen = strlen(HTMLOK), i;
00016     string::iterator ptr = s.begin(), end = s.end();
00017     <span class="keywordflow">for</span>(; ptr != end; ++ptr ) {
00018       <span class="keywordflow">for</span>( i =0; i &lt; oklen; i++ )
00019         <span class="keywordflow">if</span>( *ptr == HTMLOK[i] ) <span class="keywordflow">break</span>;
00020       
00021       <span class="keywordflow">if</span>( i == oklen ) {
00022           chg = <span class="keyword">true</span>;
00023           *ptr = HTMLBADREP;
00024       }
00025     }
00026     <span class="keywordflow">return</span> chg;
00027 }
00028 
00033 string html_spec_enc(<span class="keyword">const</span> string &amp; s) {
00034     string ret;
00035     string::const_iterator cur = s.begin(), end = s.end();
00036     ret.reserve(s.length()*2);
00037     <span class="keywordflow">for</span>( ; cur != end; cur++ ) {
00038       <span class="keywordflow">switch</span>(*cur) {
00039       <span class="keywordflow">case</span> <span class="charliteral">'&lt;'</span>:
00040         ret += <span class="stringliteral">"&amp;lt;"</span>; <span class="keywordflow">break</span>;
00041       <span class="keywordflow">case</span> <span class="charliteral">'&gt;'</span>:
00042         ret += <span class="stringliteral">"&amp;gt;"</span>; <span class="keywordflow">break</span>;
00043       <span class="keywordflow">case</span> <span class="charliteral">'"'</span>:
00044         ret += <span class="stringliteral">"&amp;quot;"</span>; <span class="keywordflow">break</span>;
00045       <span class="keywordflow">case</span> <span class="charliteral">'&amp;'</span>:
00046         ret += <span class="stringliteral">"&amp;amp;"</span>; <span class="keywordflow">break</span>;
00047       <span class="keywordflow">default</span>:
00048         ret += *cur;
00049       }
00050     }
00051     <span class="keywordflow">return</span> ret;
00052 }
00053 
00058 string html_spec_dec(<span class="keyword">const</span> string &amp; s ) {
00059     string ret, tmp;
00060     string::const_iterator cur = s.begin(), end = s.end();
00061     <span class="keywordtype">char</span> state = 0;
00062     ret.reserve(s.length());
00063     tmp.reserve(5);
00064 
00065     <span class="keywordflow">for</span>( ; cur!=end; cur++ ) {
00066       <span class="keywordflow">switch</span>(state) {
00067       <span class="keywordflow">case</span> 0:
00068         <span class="keywordflow">if</span>( *cur == <span class="charliteral">'&amp;'</span> ) {
00069           tmp = <span class="charliteral">'&amp;'</span>;
00070           state = 1;
00071         } <span class="keywordflow">else</span> ret += *cur;
00072         <span class="keywordflow">break</span>;
00073       <span class="keywordflow">case</span> 1: <span class="comment">// &amp;</span>
00074         tmp += *cur;
00075         <span class="keywordflow">switch</span>(*cur) {
00076         <span class="keywordflow">case</span> <span class="charliteral">'l'</span>:
00077           state = 2; <span class="keywordflow">break</span>;
00078         <span class="keywordflow">case</span> <span class="charliteral">'g'</span>:
00079           state = 3; <span class="keywordflow">break</span>;
00080         <span class="keywordflow">case</span> <span class="charliteral">'q'</span>:
00081           state = 4; <span class="keywordflow">break</span>;
00082         <span class="keywordflow">case</span> <span class="charliteral">'a'</span>:
00083           state = 10; <span class="keywordflow">break</span>;
00084         <span class="keywordflow">default</span>:
00085           ret += tmp;
00086           state=0;
00087         }
00088         <span class="keywordflow">break</span>;
00089       <span class="keywordflow">case</span> 2: <span class="comment">// &amp;l</span>
00090         tmp += *cur;
00091         <span class="keywordflow">switch</span>(*cur) {
00092         <span class="keywordflow">case</span> <span class="charliteral">'t'</span>: state = 5; <span class="keywordflow">break</span>;
00093         <span class="keywordflow">default</span>:
00094           ret += tmp; state = 0;
00095         } 
00096         <span class="keywordflow">break</span>;
00097       <span class="keywordflow">case</span> 3: <span class="comment">// &amp;g</span>
00098         tmp += *cur;
00099         <span class="keywordflow">switch</span>(*cur) {
00100         <span class="keywordflow">case</span> <span class="charliteral">'t'</span>: state = 6; <span class="keywordflow">break</span>;
00101         <span class="keywordflow">default</span>: ret+= tmp; state = 0;
00102         }
00103         <span class="keywordflow">break</span>;
00104       <span class="keywordflow">case</span> 4: <span class="comment">// &amp;q</span>
00105         tmp += *cur;
00106         <span class="keywordflow">switch</span>(*cur) {
00107         <span class="keywordflow">case</span> <span class="charliteral">'u'</span>: state = 7; <span class="keywordflow">break</span>;
00108         <span class="keywordflow">default</span>: ret += tmp; state = 0;
00109         } 
00110         <span class="keywordflow">break</span>;
00111       <span class="keywordflow">case</span> 5: <span class="comment">// &amp;lt</span>
00112         tmp += *cur;
00113         state = 0;
00114         <span class="keywordflow">switch</span>(*cur) {
00115         <span class="keywordflow">case</span> <span class="charliteral">';'</span>: tmp=<span class="stringliteral">""</span>; ret += <span class="charliteral">'&lt;'</span>; <span class="keywordflow">break</span>;
00116         <span class="keywordflow">default</span>: ret += tmp; tmp = <span class="stringliteral">""</span>;
00117         }
00118         <span class="keywordflow">break</span>;
00119       <span class="keywordflow">case</span> 6: <span class="comment">// &amp;gt</span>
00120         tmp += *cur;
00121         state = 0;
00122         <span class="keywordflow">switch</span>(*cur) {
00123         <span class="keywordflow">case</span> <span class="charliteral">';'</span>: tmp = <span class="stringliteral">""</span>; ret += <span class="charliteral">'&gt;'</span>; <span class="keywordflow">break</span>;
00124         <span class="keywordflow">default</span>: ret += tmp; tmp = <span class="stringliteral">""</span>;
00125         }
00126         <span class="keywordflow">break</span>;
00127       <span class="keywordflow">case</span> 7: <span class="comment">// &amp;qu</span>
00128         tmp += *cur;
00129         <span class="keywordflow">switch</span>(*cur) {
00130         <span class="keywordflow">case</span> <span class="charliteral">'o'</span>: state = 8; <span class="keywordflow">break</span>;
00131         <span class="keywordflow">default</span>: ret += tmp; state = 0;
00132         }
00133         <span class="keywordflow">break</span>;
00134       <span class="keywordflow">case</span> 8: <span class="comment">// &amp;quo</span>
00135         tmp += *cur;
00136         <span class="keywordflow">switch</span>(*cur) {
00137         <span class="keywordflow">case</span> <span class="charliteral">'t'</span>: state = 9; <span class="keywordflow">break</span>;
00138         <span class="keywordflow">default</span>: ret += tmp; state = 0;
00139         }
00140         <span class="keywordflow">break</span>;
00141       <span class="keywordflow">case</span> 9: <span class="comment">// &amp;quot</span>
00142         tmp += *cur;
00143         state = 0;
00144         <span class="keywordflow">switch</span>(*cur) {
00145         <span class="keywordflow">case</span> <span class="charliteral">';'</span>: tmp = <span class="stringliteral">""</span>; ret += <span class="charliteral">'"'</span>; <span class="keywordflow">break</span>;
00146         <span class="keywordflow">default</span>: ret += tmp; tmp = <span class="stringliteral">""</span>; 
00147         }
00148         <span class="keywordflow">break</span>;
00149       <span class="keywordflow">case</span> 10: <span class="comment">// &amp;a</span>
00150         tmp += *cur;
00151         <span class="keywordflow">switch</span>(*cur) {
00152         <span class="keywordflow">case</span> <span class="charliteral">'m'</span>: state = 11; <span class="keywordflow">break</span>;
00153         <span class="keywordflow">default</span>: ret += tmp; state = 0;
00154         }
00155         <span class="keywordflow">break</span>;
00156       <span class="keywordflow">case</span> 11: <span class="comment">// &amp;am</span>
00157         tmp += *cur;
00158         <span class="keywordflow">switch</span>(*cur) {
00159         <span class="keywordflow">case</span> <span class="charliteral">'p'</span>: state = 12; <span class="keywordflow">break</span>;
00160         <span class="keywordflow">default</span>: ret += tmp; state = 0;
00161         }
00162         <span class="keywordflow">break</span>;
00163       <span class="keywordflow">case</span> 12: <span class="comment">// &amp;amp</span>
00164         tmp += *cur;
00165         state = 0;
00166         <span class="keywordflow">switch</span>(*cur) {
00167         <span class="keywordflow">case</span> <span class="charliteral">';'</span>: tmp = <span class="stringliteral">""</span>; ret += <span class="charliteral">'&amp;'</span>; <span class="keywordflow">break</span>;
00168         <span class="keywordflow">default</span>: ret += tmp; tmp = <span class="stringliteral">""</span>;
00169         }
00170         <span class="keywordflow">break</span>;
00171       }
00172     }
00173     <span class="keywordflow">if</span>( state &amp;&amp; ! tmp.empty() ) ret += tmp;
00174     <span class="keywordflow">return</span> ret;
00175 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Dec 25 13:37:18 2003 for vqwww: freemail by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.3 </small></address>
</body>
</html>
