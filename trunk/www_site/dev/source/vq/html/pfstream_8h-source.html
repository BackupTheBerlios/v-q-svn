<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Virtual Qmail: pfstream.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.3 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a></div>
<h1>pfstream.h</h1><div class="fragment"><pre>00001 <span class="comment">//  (C) Copyright Beman Dawes 2002. Permission to copy, use, modify, sell and</span>
00002 <span class="comment">//  distribute this software is granted provided this copyright notice appears</span>
00003 <span class="comment">//  in all copies. This software is provided "as is" without express or implied</span>
00004 <span class="comment">//  warranty, and with no claim as to its suitability for any purpose.</span>
00005 
00006 <span class="comment">/*</span>
00007 <span class="comment"> * Copyright (c) 1999</span>
00008 <span class="comment"> * Silicon Graphics Computer Systems, Inc.</span>
00009 <span class="comment"> *</span>
00010 <span class="comment"> * Copyright (c) 1999 </span>
00011 <span class="comment"> * Boris Fomitchev</span>
00012 <span class="comment"> *</span>
00013 <span class="comment"> * This material is provided "as is", with absolutely no warranty expressed</span>
00014 <span class="comment"> * or implied. Any use is at your own risk.</span>
00015 <span class="comment"> *</span>
00016 <span class="comment"> * Permission to use or copy this software for any purpose is hereby granted </span>
00017 <span class="comment"> * without fee, provided the above notices are retained on all copies.</span>
00018 <span class="comment"> * Permission to modify the code and to distribute modified code is granted,</span>
00019 <span class="comment"> * provided the above notices are retained, and a notice that the code was</span>
00020 <span class="comment"> * modified is included with the above copyright notice.</span>
00021 <span class="comment"> *</span>
00022 <span class="comment"> * 2003-07-28, Code modified by Pawel Niewiadomski</span>
00023 <span class="comment"> */</span> 
00024 <span class="comment">//----------------------------------------------------------------------------// </span>
00025 
00026 <span class="preprocessor">#ifndef __PFSTREAM_H</span>
00027 <span class="preprocessor"></span><span class="preprocessor">#define __PFSTREAM_H</span>
00028 <span class="preprocessor"></span>
00029 <span class="preprocessor">#include &lt;iosfwd&gt;</span>
00030 <span class="preprocessor">#include &lt;fstream&gt;</span>
00031 <span class="preprocessor">#if __GNUC__ &lt; 3</span>
00032 <span class="preprocessor"></span><span class="preprocessor">    #include &lt;sys/types.h&gt;</span>
00033 <span class="preprocessor">    #include &lt;sys/stat.h&gt;</span>
00034 <span class="preprocessor">    #include &lt;unistd.h&gt;</span>
00035 <span class="preprocessor">#endif</span>
00036 <span class="preprocessor"></span>
00037 <span class="keyword">namespace </span>posix
00038 {
00039 <span class="preprocessor">#if __GNUC__ &gt;= 3 </span>
00040 <span class="preprocessor"></span>
00041 <span class="keyword">template</span> &lt; <span class="keyword">class</span> <span class="keywordtype">char</span>T, <span class="keyword">class</span> traits = std::<span class="keywordtype">char</span>_traits&lt;<span class="keywordtype">char</span>T&gt; &gt;
00042 <span class="keyword">class </span>basic_filebuf : <span class="keyword">public</span> std::basic_filebuf&lt;charT,traits&gt; {
00043 <span class="keyword">public</span>:
00044         <span class="keyword">typedef</span> std::basic_filebuf&lt;charT, traits&gt; __filebuf_type;
00045         <span class="keyword">typedef</span> <span class="keyword">typename</span> std::basic_filebuf&lt;charT, traits&gt;::int_type int_type;
00046         <span class="keyword">typedef</span> <span class="keyword">typename</span> std::basic_filebuf&lt;charT, traits&gt;::char_type char_type;
00047 
00048 <span class="keyword">protected</span>:
00049         char_type _M_unbuf[4];
00050 
00051 <span class="keyword">public</span>:
00052         <span class="keywordtype">int</span> fd() {
00053                 <span class="keywordflow">return</span> _M_file.fd();
00054         }
00055 
00056         __filebuf_type* open( <span class="keywordtype">int</span>, std::ios_base::openmode , 
00057                 <span class="keywordtype">bool</span> __del = <span class="keyword">true</span>, int_type __size = 0 );
00058 
00059         __filebuf_type* open( <span class="keyword">const</span> charT * __s, std::ios_base::openmode __om ) {
00060                 <span class="keywordflow">return</span> std::basic_filebuf&lt;charT, traits&gt;::open(__s, __om);
00061         }
00062 };
00063 
00064 <span class="keyword">template</span> &lt;<span class="keyword">typename</span> <span class="keywordtype">char</span>T, <span class="keyword">typename</span> traits&gt;
00065     <span class="keyword">typename</span> basic_filebuf&lt;charT, traits&gt;::__filebuf_type* 
00066     basic_filebuf&lt;charT, traits&gt;::
00067     open( <span class="keywordtype">int</span> __fd, std::ios_base::openmode __mode, 
00068             <span class="keywordtype">bool</span> __del, <span class="keyword">typename</span> basic_filebuf&lt;charT, traits&gt;::int_type __size ) {
00069         __filebuf_type *__ret = NULL;
00070         
00071         _M_file.sys_open(__fd, __mode, __del);
00072         <span class="keywordflow">if</span> (this-&gt;is_open()) {
00073                 _M_mode = __mode;
00074                 <span class="keywordflow">if</span> (__size &gt; 0 &amp;&amp; __size &lt; 4) {
00075                         <span class="comment">// Specify unbuffered.</span>
00076                         _M_buf = _M_unbuf;
00077                         _M_buf_size = __size;
00078                         _M_buf_size_opt = 0;
00079                 } <span class="keywordflow">else</span> {
00080                         _M_buf_size_opt = __size;
00081                         _M_allocate_internal_buffer();
00082                 }
00083                 _M_set_indeterminate();
00084                 __ret = <span class="keyword">this</span>;
00085         }
00086         <span class="keywordflow">return</span> __ret;
00087 }
00088 
00089 <span class="comment">//----------------------------------------------------------------------</span>
00090 <span class="comment">// Class basic_ipfstream&lt;&gt;</span>
00091 
00092 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _CharT, <span class="keyword">class</span> _Traits = std::<span class="keywordtype">char</span>_traits&lt;_CharT&gt; &gt;
00093 <span class="keyword">class </span>basic_ipfstream : <span class="keyword">public</span> std::basic_istream&lt;_CharT, _Traits&gt;
00094 {
00095 <span class="keyword">public</span>:                         <span class="comment">// Types</span>
00096   <span class="keyword">typedef</span> _CharT                     char_type;
00097   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::int_type int_type;
00098   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::pos_type pos_type;
00099   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::off_type off_type;
00100   <span class="keyword">typedef</span> _Traits                    traits_type;
00101 
00102   <span class="keyword">typedef</span> std::basic_ios&lt;_CharT, _Traits&gt;                _Basic_ios;
00103   <span class="keyword">typedef</span> std::basic_istream&lt;_CharT, _Traits&gt;            _Base;
00104   <span class="keyword">typedef</span> basic_filebuf&lt;_CharT, _Traits&gt;            _Buf;
00105 
00106 <span class="keyword">public</span>:                         <span class="comment">// Constructors, destructor.</span>
00107 
00108   basic_ipfstream() : 
00109     std::basic_ios&lt;_CharT, _Traits&gt;(),  std::basic_istream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00110       this-&gt;init(&amp;_M_buf);
00111   }
00112 
00113   <span class="keyword">explicit</span> basic_ipfstream(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s, ios_base::openmode __mod = ios_base::in) : 
00114     std::basic_ios&lt;_CharT, _Traits&gt;(),  std::basic_istream&lt;_CharT, _Traits&gt;(0),
00115     _M_buf() {
00116       this-&gt;init(&amp;_M_buf);
00117       <span class="keywordflow">if</span> (!_M_buf.open(__s, __mod | ios_base::in))
00118     this-&gt;setstate(ios_base::failbit);
00119   }
00120 
00121 <span class="preprocessor"># ifndef _STLP_NO_EXTENSIONS</span>
00122 <span class="preprocessor"></span>  <span class="keyword">explicit</span> basic_ipfstream(<span class="keywordtype">int</span> __id, ios_base::openmode __mod = ios_base::in) : 
00123     std::basic_ios&lt;_CharT, _Traits&gt;(),  std::basic_istream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00124     this-&gt;init(&amp;_M_buf);
00125     <span class="keywordflow">if</span> (!_M_buf.open(__id, __mod | ios_base::in))
00126       this-&gt;setstate(ios_base::failbit);
00127   }
00128   basic_ipfstream(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s, ios_base::openmode __m,
00129          <span class="keywordtype">long</span> __protection) : 
00130     std::basic_ios&lt;_CharT, _Traits&gt;(),  std::basic_istream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00131     this-&gt;init(&amp;_M_buf);
00132     <span class="keywordflow">if</span> (!_M_buf.open(__s, __m | ios_base::in, __protection))
00133       this-&gt;setstate(ios_base::failbit);  
00134   }
00135   
00136 <span class="preprocessor"># endif</span>
00137 <span class="preprocessor"></span>
00138   ~basic_ipfstream() {}
00139 
00140 <span class="keyword">public</span>:                         <span class="comment">// File and buffer operations.</span>
00141   _Buf * rdbuf()<span class="keyword"> const</span>
00142 <span class="keyword">    </span>{ <span class="keywordflow">return</span> const_cast&lt;_Buf*&gt;(&amp;_M_buf); }
00143 
00144   <span class="keywordtype">bool</span> is_open() {
00145     <span class="keywordflow">return</span> this-&gt;rdbuf()-&gt;is_open();
00146   }
00147 
00148   <span class="keywordtype">void</span> open(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s, ios_base::openmode __mod = ios_base::in) {
00149     <span class="keywordflow">if</span> (!this-&gt;rdbuf()-&gt;open(__s, __mod | ios_base::in))
00150       this-&gt;setstate(ios_base::failbit);
00151   }
00152 
00153   <span class="keywordtype">void</span> close() {
00154     <span class="keywordflow">if</span> (!this-&gt;rdbuf()-&gt;close())
00155       this-&gt;setstate(ios_base::failbit);
00156   }
00157 
00158   <span class="keywordtype">int</span> fd() {
00159     <span class="keywordflow">return</span> _M_buf.fd();
00160   }
00161 
00162 <span class="keyword">private</span>:
00163   _Buf _M_buf;
00164 };
00165 
00166 
00167 <span class="comment">//----------------------------------------------------------------------</span>
00168 <span class="comment">// Class basic_opfstream&lt;&gt;</span>
00169 
00170 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _CharT, <span class="keyword">class</span> _Traits = std::<span class="keywordtype">char</span>_traits&lt;_CharT&gt; &gt;
00171 <span class="keyword">class </span>basic_opfstream : <span class="keyword">public</span> std::basic_ostream&lt;_CharT, _Traits&gt;
00172 {
00173 <span class="keyword">public</span>:                         <span class="comment">// Types</span>
00174   <span class="keyword">typedef</span> _CharT                     char_type;
00175   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::int_type int_type;
00176   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::pos_type pos_type;
00177   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::off_type off_type;
00178   <span class="keyword">typedef</span> _Traits                    traits_type;
00179 
00180   <span class="keyword">typedef</span> std::basic_ios&lt;_CharT, _Traits&gt;                _Basic_ios;
00181   <span class="keyword">typedef</span> std::basic_ostream&lt;_CharT, _Traits&gt;            _Base;
00182   <span class="keyword">typedef</span> basic_filebuf&lt;_CharT, _Traits&gt;            _Buf;
00183 
00184 <span class="keyword">public</span>:                         <span class="comment">// Constructors, destructor.</span>
00185   basic_opfstream() : 
00186     std::basic_ios&lt;_CharT, _Traits&gt;(), 
00187     std::basic_ostream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00188       this-&gt;init(&amp;_M_buf);
00189   }
00190   <span class="keyword">explicit</span> basic_opfstream(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s, ios_base::openmode __mod = ios_base::out) 
00191     : std::basic_ios&lt;_CharT, _Traits&gt;(), std::basic_ostream&lt;_CharT, _Traits&gt;(0),
00192       _M_buf() {
00193     this-&gt;init(&amp;_M_buf);
00194     <span class="keywordflow">if</span> (!_M_buf.open(__s, __mod | ios_base::out))
00195       this-&gt;setstate(ios_base::failbit);
00196   }
00197 
00198 <span class="preprocessor"># ifndef _STLP_NO_EXTENSIONS</span>
00199 <span class="preprocessor"></span>  <span class="keyword">explicit</span> basic_opfstream(<span class="keywordtype">int</span> __id, ios_base::openmode __mod = ios_base::out) 
00200     : std::basic_ios&lt;_CharT, _Traits&gt;(), std::basic_ostream&lt;_CharT, _Traits&gt;(0),
00201     _M_buf() {
00202     this-&gt;init(&amp;_M_buf);
00203     <span class="keywordflow">if</span> (!_M_buf.open(__id, __mod | ios_base::out))
00204       this-&gt;setstate(ios_base::failbit);
00205   }
00206   basic_opfstream(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s, ios_base::openmode __m, <span class="keywordtype">long</span> __protection) : 
00207     std::basic_ios&lt;_CharT, _Traits&gt;(),  std::basic_ostream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00208     this-&gt;init(&amp;_M_buf);
00209     <span class="keywordflow">if</span> (!_M_buf.open(__s, __m | ios_base::out, __protection))
00210       this-&gt;setstate(ios_base::failbit);  
00211   }
00212 <span class="preprocessor"># endif</span>
00213 <span class="preprocessor"></span>  
00214   ~basic_opfstream() {}
00215 
00216 <span class="keyword">public</span>:                         <span class="comment">// File and buffer operations.</span>
00217   _Buf * rdbuf()<span class="keyword"> const</span>
00218 <span class="keyword">    </span>{ <span class="keywordflow">return</span> const_cast&lt;_Buf*&gt;(&amp;_M_buf); } 
00219 
00220   <span class="keywordtype">bool</span> is_open() {
00221     <span class="keywordflow">return</span> this-&gt;rdbuf()-&gt;is_open();
00222   }
00223 
00224   <span class="keywordtype">void</span> open(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s, ios_base::openmode __mod= ios_base::out) {
00225     <span class="keywordflow">if</span> (!this-&gt;rdbuf()-&gt;open(__s, __mod | ios_base::out))
00226       this-&gt;setstate(ios_base::failbit);
00227   }
00228 
00229   <span class="keywordtype">void</span> close() {
00230     <span class="keywordflow">if</span> (!this-&gt;rdbuf()-&gt;close())
00231       this-&gt;setstate(ios_base::failbit);
00232   }
00233 
00234   <span class="keywordtype">int</span> fd() {
00235     <span class="keywordflow">return</span> _M_buf.fd();
00236   }
00237 
00238 <span class="keyword">private</span>:
00239   _Buf _M_buf;
00240 };
00241 
00242 
00243 <span class="comment">//----------------------------------------------------------------------</span>
00244 <span class="comment">// Class basic_pfstream&lt;&gt;</span>
00245 
00246 <span class="keyword">template</span> &lt;<span class="keyword">class</span> _CharT, <span class="keyword">class</span> _Traits = std::<span class="keywordtype">char</span>_traits&lt;_CharT&gt; &gt;
00247 <span class="keyword">class </span>basic_pfstream : <span class="keyword">public</span> std::basic_iostream&lt;_CharT, _Traits&gt;
00248 {
00249 <span class="keyword">public</span>:                         <span class="comment">// Types</span>
00250   <span class="keyword">typedef</span> _CharT                     char_type;
00251   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::int_type int_type;
00252   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::pos_type pos_type;
00253   <span class="keyword">typedef</span> <span class="keyword">typename</span> _Traits::off_type off_type;
00254   <span class="keyword">typedef</span> _Traits                    traits_type;
00255 
00256   <span class="keyword">typedef</span> std::basic_ios&lt;_CharT, _Traits&gt;                _Basic_ios;
00257   <span class="keyword">typedef</span> std::basic_iostream&lt;_CharT, _Traits&gt;           _Base;
00258   <span class="keyword">typedef</span> basic_filebuf&lt;_CharT, _Traits&gt;            _Buf;
00259 
00260 <span class="keyword">public</span>:                         <span class="comment">// Constructors, destructor.</span>
00261   
00262   basic_pfstream()   
00263     : std::basic_ios&lt;_CharT, _Traits&gt;(), std::basic_iostream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00264       this-&gt;init(&amp;_M_buf);
00265   }
00266 
00267   <span class="keyword">explicit</span> basic_pfstream(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s,
00268                          ios_base::openmode __mod = ios_base::in | ios_base::out) :
00269     std::basic_ios&lt;_CharT, _Traits&gt;(), std::basic_iostream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00270       this-&gt;init(&amp;_M_buf);
00271       <span class="keywordflow">if</span> (!_M_buf.open(__s, __mod))
00272     this-&gt;setstate(ios_base::failbit);
00273   }
00274   
00275 <span class="preprocessor"># ifndef _STLP_NO_EXTENSIONS</span>
00276 <span class="preprocessor"></span>  <span class="keyword">explicit</span> basic_pfstream(<span class="keywordtype">int</span> __id,
00277                          ios_base::openmode __mod = ios_base::in | ios_base::out) :
00278     std::basic_ios&lt;_CharT, _Traits&gt;(), std::basic_iostream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00279     this-&gt;init(&amp;_M_buf);
00280     <span class="keywordflow">if</span> (!_M_buf.open(__id, __mod))
00281       this-&gt;setstate(ios_base::failbit);
00282   }
00283   basic_pfstream(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s, ios_base::openmode __m, <span class="keywordtype">long</span> __protection) : 
00284     std::basic_ios&lt;_CharT, _Traits&gt;(),  std::basic_iostream&lt;_CharT, _Traits&gt;(0), _M_buf() {
00285     this-&gt;init(&amp;_M_buf);
00286     <span class="keywordflow">if</span> (!_M_buf.open(__s, __m, __protection))
00287       this-&gt;setstate(ios_base::failbit);  
00288   }
00289 <span class="preprocessor"># endif    </span>
00290 <span class="preprocessor"></span>  ~basic_pfstream() {}
00291 
00292 <span class="keyword">public</span>:                         <span class="comment">// File and buffer operations.</span>
00293 
00294   _Buf * rdbuf()<span class="keyword"> const</span>
00295 <span class="keyword">    </span>{ <span class="keywordflow">return</span> const_cast&lt;_Buf*&gt;(&amp;_M_buf); } 
00296 
00297   <span class="keywordtype">bool</span> is_open() {
00298     <span class="keywordflow">return</span> this-&gt;rdbuf()-&gt;is_open();
00299   }
00300 
00301   <span class="keywordtype">void</span> open(<span class="keyword">const</span> <span class="keywordtype">char</span>* __s, 
00302         ios_base::openmode __mod = 
00303         ios_base::in | ios_base::out) {
00304     <span class="keywordflow">if</span> (!this-&gt;rdbuf()-&gt;open(__s, __mod))
00305       this-&gt;setstate(ios_base::failbit);
00306   }
00307   
00308   <span class="keywordtype">void</span> close() {
00309     <span class="keywordflow">if</span> (!this-&gt;rdbuf()-&gt;close())
00310       this-&gt;setstate(ios_base::failbit);
00311   }
00312 
00313   <span class="keywordtype">int</span> fd() {
00314     <span class="keywordflow">return</span> _M_buf.fd();
00315   }
00316   
00317 <span class="keyword">private</span>:
00318   _Buf _M_buf;
00319 };
00320 
00321 <span class="keyword">typedef</span> basic_pfstream&lt;char&gt; pfstream;
00322 <span class="keyword">typedef</span> basic_ipfstream&lt;char&gt; ipfstream;
00323 <span class="keyword">typedef</span> basic_opfstream&lt;char&gt; opfstream;
00324 
00325 <span class="preprocessor">#else</span>
00326 <span class="preprocessor"></span>
00327 <span class="keyword">class </span>pfstream : <span class="keyword">public</span> fstream {
00328         <span class="keyword">public</span>:
00329                 pfstream() {}
00330                 pfstream(<span class="keywordtype">int</span> fd) : fstream(fd) {}
00331                 pfstream(<span class="keyword">const</span> <span class="keywordtype">char</span> *fn, <span class="keywordtype">int</span> mode, <span class="keywordtype">int</span> prot=0644) {
00332                     open(fn, mode, prot);
00333                 }
00334                 <span class="keywordtype">void</span> open(<span class="keyword">const</span> <span class="keywordtype">char</span> *fn, <span class="keywordtype">int</span> mode, <span class="keywordtype">int</span> prot=0644) {
00335                     <span class="keyword">struct </span>stat st;
00336                     <span class="keywordflow">if</span>( (mode &amp; in) &amp;&amp; stat(fn, &amp;st) ) {
00337                             setstate(badbit);
00338                             <span class="keywordflow">return</span>;
00339                     }
00340                     fstream::open(fn, mode, prot);
00341                 }
00342 };
00343         
00344 <span class="keyword">class </span>ipfstream : <span class="keyword">public</span> ifstream {
00345         <span class="keyword">public</span>:
00346                 ipfstream() {}
00347                 ipfstream(<span class="keywordtype">int</span> fd) : ifstream(fd) {}
00348                 ipfstream(<span class="keyword">const</span> <span class="keywordtype">char</span> *fn, <span class="keywordtype">int</span> mode = in, <span class="keywordtype">int</span> prot=0644) {
00349                     open(fn, mode, prot);
00350                 }
00351                 <span class="keywordtype">void</span> open(<span class="keyword">const</span> <span class="keywordtype">char</span> *fn, <span class="keywordtype">int</span> mode = in, <span class="keywordtype">int</span> prot=0644) {
00352                     <span class="keyword">struct </span>stat st;
00353                     <span class="keywordflow">if</span>( (mode &amp; in) &amp;&amp; stat(fn, &amp;st) ) {
00354                             setstate(badbit);
00355                             <span class="keywordflow">return</span>;
00356                     }
00357                     ifstream::open(fn, mode, prot);
00358                 }
00359 };
00360 
00361 <span class="keyword">class </span>opfstream : <span class="keyword">public</span> ofstream {
00362         <span class="keyword">public</span>:
00363                 opfstream() {}
00364                 opfstream(<span class="keywordtype">int</span> fd) : ofstream(fd) {}
00365                 opfstream(<span class="keyword">const</span> <span class="keywordtype">char</span> *fn, <span class="keywordtype">int</span> mode = out, <span class="keywordtype">int</span> prot=0644) {
00366                     open(fn, mode, prot);
00367                 }
00368                 <span class="keywordtype">void</span> open(<span class="keyword">const</span> <span class="keywordtype">char</span> *fn, <span class="keywordtype">int</span> mode = out, <span class="keywordtype">int</span> prot=0644) {
00369                     <span class="keyword">struct </span>stat st;
00370                     <span class="keywordflow">if</span>( (mode &amp; in) &amp;&amp; stat(fn, &amp;st) ) {
00371                             setstate(badbit);
00372                             <span class="keywordflow">return</span>;
00373                     }
00374                     ofstream::open(fn, mode, prot);
00375                 }
00376 
00377 };
00378 
00379 <span class="preprocessor">#endif</span>
00380 <span class="preprocessor"></span>} <span class="comment">// namespace boost</span>
00381 
00382 <span class="preprocessor">#endif  // __PFSTREAM_H</span>
00383 <span class="preprocessor"></span>
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Dec 25 13:37:10 2003 for Virtual Qmail by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.3 </small></address>
</body>
</html>
