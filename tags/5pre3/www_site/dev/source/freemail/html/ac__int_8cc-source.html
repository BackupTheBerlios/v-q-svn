<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>vqwww: freemail: ac_int.cc Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.3 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a></div>
<h1>ac_int.cc</h1><div class="fragment"><pre>00001 <span class="preprocessor">#include &lt;exception&gt;</span>
00002 <span class="preprocessor">#include &lt;iostream&gt;</span>
00003 <span class="preprocessor">#include &lt;fstream&gt;</span>
00004 <span class="preprocessor">#include &lt;sstream&gt;</span>
00005 <span class="preprocessor">#include &lt;string&gt;</span>
00006 <span class="preprocessor">#include &lt;cerrno&gt;</span>
00007 
00008 <span class="preprocessor">#include "conf_home.h"</span>
00009 
00010 <span class="keyword">using</span> <span class="keyword">namespace </span>std;
00011 <span class="keyword">using</span> <span class="keyword">namespace </span>HOME_NS;
00012 
00013 <span class="keywordtype">void</span> usage(<span class="keyword">const</span> <span class="keywordtype">char</span> *me) {
00014     cerr&lt;&lt;<span class="stringliteral">"usage: "</span>&lt;&lt;me&lt;&lt;<span class="stringliteral">" namespace name [multi] [class]"</span>&lt;&lt;endl
00015         &lt;&lt;<span class="stringliteral">"reads value from stdin"</span>&lt;&lt;endl;
00016 }
00017 
00018 <span class="keywordtype">int</span> main(<span class="keywordtype">int</span> ac, <span class="keywordtype">char</span> **av) {
00019     <span class="keywordflow">try</span> {
00020             <span class="keywordflow">if</span>(ac&lt;3) {
00021                     usage(*av);
00022                     <span class="keywordflow">return</span> 1;
00023             }
00024     
00025             string ln;
00026             getline(cin, ln);
00027             <span class="keywordflow">if</span>( cin.bad() || ln.empty() ) {
00028                     cerr&lt;&lt;<span class="stringliteral">"can't read input"</span>&lt;&lt;endl;
00029                     <span class="keywordflow">return</span> 1;
00030             }
00031                      
00032             <span class="keywordtype">int</span> val, mult=1;
00033             istringstream sval;
00034             
00035             sval.str(ln);
00036             <span class="keywordflow">if</span>(ln[0] == <span class="charliteral">'0'</span>) sval&gt;&gt;oct&gt;&gt;val;
00037             <span class="keywordflow">else</span> sval&gt;&gt;val;
00038 
00039             <span class="keywordflow">if</span>(!sval) {
00040                     cerr&lt;&lt;ln&lt;&lt;<span class="stringliteral">" isn't a number"</span>&lt;&lt;endl;
00041                     <span class="keywordflow">return</span> 4;
00042             }
00043             
00044             <span class="keywordflow">if</span>( ac == 4 ) {
00045                     sval.clear();
00046                     sval.str(av[3]);
00047                     sval&gt;&gt;mult;
00048                     <span class="keywordflow">if</span>(! sval) {
00049                             cerr&lt;&lt;av[3]&lt;&lt;<span class="stringliteral">" isn't a number"</span>&lt;&lt;endl;
00050                             <span class="keywordflow">return</span> 5;
00051                     }
00052             }
00053 
00054             string ac_conf(<span class="stringliteral">"auto/"</span>);
00055             ac_conf+=av[2];
00056             ac_conf+=<span class="stringliteral">".cc"</span>;
00057             
00058             ofstream out(ac_conf.c_str(), ios::trunc);
00059             out&lt;&lt;<span class="stringliteral">"// file autogenerated, don't edit!"</span>&lt;&lt;endl
00060                 &lt;&lt;<span class="stringliteral">"#include \"../cconf.h\""</span>&lt;&lt;endl
00061                 &lt;&lt;<span class="stringliteral">"namespace "</span>&lt;&lt;av[1]&lt;&lt;<span class="stringliteral">" {"</span>&lt;&lt;endl&lt;&lt;<span class="charliteral">'\t'</span>;
00062 
00063             <span class="keywordflow">if</span>(ac==5)
00064                     out&lt;&lt;av[4];
00065             <span class="keywordflow">else</span> 
00066                     out&lt;&lt;<span class="stringliteral">"cintconf"</span>;
00067 
00068             out&lt;&lt;<span class="stringliteral">" ac_"</span>&lt;&lt;av[2]&lt;&lt;<span class="stringliteral">"(\""</span>&lt;&lt;conf_home
00069                 &lt;&lt;<span class="stringliteral">"/etc/vq/"</span>&lt;&lt;av[2]&lt;&lt;<span class="stringliteral">"\",\""</span>
00070                 &lt;&lt;val&lt;&lt;<span class="stringliteral">"\""</span>;
00071             
00072             <span class="keywordflow">if</span>( mult != 1 ) {
00073                 out&lt;&lt;<span class="stringliteral">", "</span>&lt;&lt;mult;
00074             }
00075 
00076             out&lt;&lt;<span class="stringliteral">");"</span>&lt;&lt;endl
00077                 &lt;&lt;<span class="stringliteral">"} // namespace "</span>&lt;&lt;av[1]&lt;&lt;endl;
00078             out.close();
00079 
00080             <span class="keywordflow">if</span>(! out) {
00081                 cerr&lt;&lt;<span class="stringliteral">"can't write: "</span>&lt;&lt;ac_conf&lt;&lt;<span class="stringliteral">": "</span>&lt;&lt;strerror(errno)&lt;&lt;endl;
00082                 <span class="keywordflow">return</span> 1;
00083             }
00084     } <span class="keywordflow">catch</span>( <span class="keyword">const</span> exception &amp; e ) {
00085             cerr&lt;&lt;<span class="stringliteral">"exception: "</span>&lt;&lt;e.what()&lt;&lt;endl;
00086             <span class="keywordflow">return</span> 1;
00087     }
00088     <span class="keywordflow">return</span> 0;
00089 }
</pre></div><hr size="1"><address style="align: right;"><small>Generated on Thu Dec 25 13:37:18 2003 for vqwww: freemail by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.3 </small></address>
</body>
</html>
