<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>Virtual Qmail: Files manipulation</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.3.3 -->
<div class="qindex"><a class="qindex" href="index.html">Main&nbsp;Page</a> | <a class="qindex" href="modules.html">Modules</a> | <a class="qindex" href="hierarchy.html">Class&nbsp;Hierarchy</a> | <a class="qindex" href="classes.html">Alphabetical&nbsp;List</a> | <a class="qindex" href="annotated.html">Compound&nbsp;List</a> | <a class="qindex" href="files.html">File&nbsp;List</a> | <a class="qindex" href="functions.html">Compound&nbsp;Members</a></div>
<h1>Files manipulation</h1><table border=0 cellpadding=0 cellspacing=0>
<tr><td></td></tr>
<tr><td colspan=2><br><h2>Functions</h2></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>uint8_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__file.html#a0">cfsvq::file_add</a> (const std::string &amp;, const std::string &amp;, std::string &amp;, bool=false)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds line to a file. </em> <a href="#a0"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>uint8_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__file.html#a1">cfsvq::file_add</a> (const std::string &amp;fn, mode_t mode, const std::string &amp;eof_mark, const std::string &amp;item_mark, bool item_whole, const std::string &amp;item_add, uint8_t ex, std::string &amp;fntmp)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Adds line to a file. </em> <a href="#a1"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>uint8_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__file.html#a2">cfsvq::file_rm</a> (const std::string &amp;, const std::string &amp;, std::string &amp;)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Removes line from a file. </em> <a href="#a2"></a><em><br><br></td></tr>
<tr><td class="memItemLeft" nowrap align=right valign=top>uint8_t&nbsp;</td><td class="memItemRight" valign=bottom><a class="el" href="group__file.html#a3">cfsvq::tmp_crt</a> (const std::string &amp;, posix::opfstream &amp;, std::string &amp;)</td></tr>

<tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight">Creates temporary file. </em> <a href="#a3"></a><em><br><br></td></tr>
</table>
<hr><h2>Function Documentation</h2>
<a name="a1" doxytag="cfsvq::file_add"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> uint8_t cfsvq::file_add </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>fn</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>mode_t&nbsp;</td>
          <td class="mdname" nowrap> <em>mode</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>eof_mark</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>item_mark</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>item_whole</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>item_add</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>uint8_t&nbsp;</td>
          <td class="mdname" nowrap> <em>ex</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>fntmp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, inherited]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds line to a file. 
<p>
Write data to file in a safe maner. It opens file, creates temporary file, copies data to it (until end of file or specified line was found), closes data. It stats original file, and change mode and owner of created file. It write information about temporary file name into fntmp. Caller needs to rename it.<p>
<dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>fn</em>&nbsp;</td><td>path to file that is going to be changed </td></tr>
    <tr><td valign=top><em>mode</em>&nbsp;</td><td>default mode of created file (if it does not exists) </td></tr>
    <tr><td valign=top><em>eof_mark</em>&nbsp;</td><td>if not empty original file is read until line including it </td></tr>
    <tr><td valign=top><em>item_mark</em>&nbsp;</td><td>mark of existence </td></tr>
    <tr><td valign=top><em>item_whole</em>&nbsp;</td><td>if true match whole line while looking for existence </td></tr>
    <tr><td valign=top><em>item_add</em>&nbsp;</td><td>this will be added to file </td></tr>
    <tr><td valign=top><em>ex</em>&nbsp;</td><td>this value will be returned if entry is in file </td></tr>
    <tr><td valign=top><em>fntmp</em>&nbsp;</td><td>temporary file's name</td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>error code, 0 on success, or value of ex if entry was found. </dd></dl>

<p>
Definition at line <a class="el" href="cfsvq_8cc-source.html#l00097">97</a> of file <a class="el" href="cfsvq_8cc-source.html">cfsvq.cc</a>.
<p>
References <a class="el" href="classcvq.html#a16cvqw14">cvq::err_chmod</a>, <a class="el" href="classcvq.html#a16cvqw17">cvq::err_chown</a>, <a class="el" href="classcvq.html#a16cvqw15">cvq::err_lckd</a>, <a class="el" href="classcvq.html#a16cvqw2">cvq::err_no</a>, <a class="el" href="classcvq.html#a16cvqw9">cvq::err_open</a>, <a class="el" href="classcvq.html#a16cvqw11">cvq::err_rd</a>, <a class="el" href="classcvq.html#a16cvqw12">cvq::err_stat</a>, <a class="el" href="classcvq.html#a16cvqw10">cvq::err_wr</a>, <a class="el" href="cvq_8cc-source.html#l00150">cvq::lr()</a>, and <a class="el" href="cconf_8cc-source.html#l00129">cintconf::val_int()</a>.    </td>
  </tr>
</table>
<a name="a0" doxytag="cfsvq::file_add"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> uint8_t cfsvq::file_add </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>fn</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>item</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>fntmp</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>bool&nbsp;</td>
          <td class="mdname" nowrap> <em>beg_at</em> = false</td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, inherited]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Adds line to a file. 
<p>
Add line to a file. Create temporary file, copy content to it, add item, return temporary file's name. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>fn</em>&nbsp;</td><td>file when we add a line </td></tr>
    <tr><td valign=top><em>item</em>&nbsp;</td><td>line to add </td></tr>
    <tr><td valign=top><em>fntmp</em>&nbsp;</td><td>temp. file's name </td></tr>
    <tr><td valign=top><em>beg_at</em>&nbsp;</td><td>if true add line at begining </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 if success </dd></dl>

<p>
Definition at line <a class="el" href="cfsvq_8cc-source.html#l00484">484</a> of file <a class="el" href="cfsvq_8cc-source.html">cfsvq.cc</a>.
<p>
References <a class="el" href="classcvq.html#a16cvqw14">cvq::err_chmod</a>, <a class="el" href="classcvq.html#a16cvqw17">cvq::err_chown</a>, <a class="el" href="classcvq.html#a16cvqw15">cvq::err_lckd</a>, <a class="el" href="classcvq.html#a16cvqw2">cvq::err_no</a>, <a class="el" href="classcvq.html#a16cvqw9">cvq::err_open</a>, <a class="el" href="classcvq.html#a16cvqw11">cvq::err_rd</a>, <a class="el" href="classcvq.html#a16cvqw12">cvq::err_stat</a>, <a class="el" href="classcvq.html#a16cvqw10">cvq::err_wr</a>, <a class="el" href="cvq_8cc-source.html#l00150">cvq::lr()</a>, and <a class="el" href="cconf_8cc-source.html#l00129">cintconf::val_int()</a>.
<p>
Referenced by <a class="el" href="cfsvq_8cc-source.html#l00890">cfsvq::udot_add()</a>.    </td>
  </tr>
</table>
<a name="a2" doxytag="cfsvq::file_rm"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> uint8_t cfsvq::file_rm </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>fn</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>item</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>fntmp</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, inherited]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Removes line from a file. 
<p>
Remove line from a file. Lock original file, copy content to a temporary file and return it's name. Caller will rename temporary file to original. <dl compact><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign=top><em>fn</em>&nbsp;</td><td>name of file </td></tr>
    <tr><td valign=top><em>item</em>&nbsp;</td><td>line to remove </td></tr>
    <tr><td valign=top><em>fntmp</em>&nbsp;</td><td>temporary file name </td></tr>
  </table>
</dl>
<dl compact><dt><b>Returns:</b></dt><dd>0 if success </dd></dl>

<p>
Definition at line <a class="el" href="cfsvq_8cc-source.html#l00354">354</a> of file <a class="el" href="cfsvq_8cc-source.html">cfsvq.cc</a>.
<p>
References <a class="el" href="classcvq.html#a16cvqw14">cvq::err_chmod</a>, <a class="el" href="classcvq.html#a16cvqw17">cvq::err_chown</a>, <a class="el" href="classcvq.html#a16cvqw15">cvq::err_lckd</a>, <a class="el" href="classcvq.html#a16cvqw2">cvq::err_no</a>, <a class="el" href="classcvq.html#a16cvqw9">cvq::err_open</a>, <a class="el" href="classcvq.html#a16cvqw11">cvq::err_rd</a>, <a class="el" href="classcvq.html#a16cvqw12">cvq::err_stat</a>, <a class="el" href="classcvq.html#a16cvqw10">cvq::err_wr</a>, and <a class="el" href="cvq_8cc-source.html#l00150">cvq::lr()</a>.    </td>
  </tr>
</table>
<a name="a3" doxytag="cfsvq::tmp_crt"></a><p>
<table class="mdTable" width="100%" cellpadding="2" cellspacing="0">
  <tr>
    <td class="mdRow">
      <table cellpadding="0" cellspacing="0" border="0">
        <tr>
          <td class="md" nowrap valign="top"> uint8_t cfsvq::tmp_crt </td>
          <td class="md" valign="top">(&nbsp;</td>
          <td class="md" nowrap valign="top">const std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>fn</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>posix::opfstream &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>out</em>, </td>
        </tr>
        <tr>
          <td></td>
          <td></td>
          <td class="md" nowrap>std::string &amp;&nbsp;</td>
          <td class="mdname" nowrap> <em>fnout</em></td>
        </tr>
        <tr>
          <td></td>
          <td class="md">)&nbsp;</td>
          <td class="md" colspan="2"><code> [protected, inherited]</code></td>
        </tr>

      </table>
    </td>
  </tr>
</table>
<table cellspacing=5 cellpadding=0 border=0>
  <tr>
    <td>
      &nbsp;
    </td>
    <td>

<p>
Creates temporary file. 
<p>
creates temporary file, chown(vq), chmod(vq_mode) 
<p>
Definition at line <a class="el" href="cfsvq_8cc-source.html#l01157">1157</a> of file <a class="el" href="cfsvq_8cc-source.html">cfsvq.cc</a>.
<p>
References <a class="el" href="classcvq.html#a16cvqw14">cvq::err_chmod</a>, <a class="el" href="classcvq.html#a16cvqw17">cvq::err_chown</a>, <a class="el" href="classcvq.html#a16cvqw2">cvq::err_no</a>, <a class="el" href="classcvq.html#a16cvqw9">cvq::err_open</a>, <a class="el" href="cvq_8cc-source.html#l00150">cvq::lr()</a>, <a class="el" href="cfsvq_8cc-source.html#l00065">cfsvq::tmp_end</a>, and <a class="el" href="cconf_8cc-source.html#l00129">cintconf::val_int()</a>.
<p>
Referenced by <a class="el" href="cfsvq_8cc-source.html#l00991">cfsvq::udot_rep()</a>, and <a class="el" href="cfsvq_8cc-source.html#l00919">cfsvq::udot_rm()</a>.    </td>
  </tr>
</table>
<hr size="1"><address style="align: right;"><small>Generated on Thu Dec 25 13:37:12 2003 for Virtual Qmail by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border=0 > 
</a>1.3.3 </small></address>
</body>
</html>
